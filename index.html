<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cryptoPage</title>
    <script src="https://kit.fontawesome.com/392d0a80d8.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./tailwind.css">
    <link rel="icon" href="./images/favicon.png" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script>
    <script src="./contract.js"></script>
    <script src="./pcsRouter.js"></script>
</head>

<body style="margin: auto;">
    <nav class="bg-white">
        <div class="flex flex-row justify-between  mx-auto items-center py-2  px-5 max-w-screen-lg ">
            <div class=" ">
                <img style="height: 100px;width: 160px;" src="./images/SD with coins .png" alt="">
            </div>
            <div class="rounded relative w-full max-w-xl mr-6  flex">
                <input id="addy" style="background-color: white;border-color: #F969B4;" type="text" class="rounded-l py-2 border block w-full text-sm focus:outline-none text-gray-300 form-input leading-5  border-gray-700 focus:shadow-outline-purple focus:border-gray-600 focus:shadow-outline-gray bg-gray-700 pl-8  focus:ring-2 focus:ring-gray-400"
                    placeholder="Paste your address here" />
                <button onclick="init()" style="background-color: #F969B4; color: black;border-color: #F969B4;" class="py-2 px-4 bg-gray-600 rounded-r text-gray-300 focus:outline-none focus:ring-2 focus:ring- #FFDCDC-700 focus:shadow-outline-gray">SUBMIT</button>
            </div>
            <div>
            </div>
        </div>
    </nav>

    <div class=" mx-auto  mb-5 bg-white">
        <section class="">
            <div class="w-11/12  mx-auto ">
                <h3 style="text-align: center;font-size: 30px;" class="text-4xl font-semibold text-black py-3">Sugar Daddy Doge Earnings Manager</h3>
                <div style="background-color: #F969B4;font-size: 30px;" class="text-white text-xl flex flex-row justify-between p-3 my-3 rounded bg-purple-600">
                    <div>
                        <h5>Please enter your address above</h5>
                    </div>
                    <div>
                        <h5>
                            Buy More SugarDaddyDoge
                        </h5>
                    </div>
                </div>
                <div class="grid gap-6 md:grid-cols-2 xl:grid-cols-4  ">
                    <div style="background-color:  #FFDCDC;" class="min-w-0 rounded-lg shadow-xs overflow-hidden bg- #FFDCDC-900">
                        <div class="p-4 flex items-center">
                            <div class="p-3 rounded-md text-orange-100 bg-orange-500 mr-4">
                                <i class="fa fa-th-large text-2xl text-white"></i>
                            </div>
                            <div>
                                <p style="color: black;" class="mb-2 text-sm font-medium ">Your SugarDaddyDoge Holdings</p>
                                <p style="color: black;" class="text-lg font-semibold text-gray-200"><span id="yHoldings"></span> SugarDaddyDoge</p>
                            </div>
                        </div>
                    </div>
                    <div style="background-color:  #FFDCDC;" class="min-w-0 rounded-lg shadow-xs overflow-hidden bg- #FFDCDC-900">
                        <div class="p-4 flex items-center">
                            <div class="p-3 rounded-md text-orange-100 bg-orange-500 mr-4">
                                <i class="fa fa-th-large text-2xl text-white"></i>
                            </div>
                            <div>
                                <p style="color: black;" class="mb-2 text-sm font-medium ">Total BNB paid</p>
                                <p style="color: black;" class="text-lg font-semibold text-gray-200"><span id="yBnbClaim"></span> BNB</p>
                            </div>
                        </div>
                    </div>
                    <div style="background-color:  #FFDCDC;" class="min-w-0 rounded-lg shadow-xs overflow-hidden bg- #FFDCDC-900">
                        <div class="p-4 flex items-center">
                            <div class="p-3 rounded-md text-orange-100 bg-orange-500 mr-4">
                                <i class="fa fa-th-large text-2xl text-white"></i>
                            </div>
                            <div>
                                <p style="color: black;" class="mb-2 text-sm font-medium ">Last Payout time</p>
                                <p style="color: black;" class="text-lg font-semibold text-gray-200"><span id="LpayOut"></span></p>
                            </div>
                        </div>
                    </div>
                    <div style="background-color:  #FFDCDC;" class="min-w-0 rounded-lg shadow-xs overflow-hidden bg- #FFDCDC-900">
                        <div class="p-4 flex items-center">
                            <div class="p-3 rounded-md text-orange-100 bg-orange-500 mr-4">
                                <i class="fa fa-th-large text-2xl text-white"></i>
                            </div>
                            <div>
                                <p style="color: black;" class="mb-2 text-sm font-medium ">Payout Loading</p>
                                <p style="color: black;" class="text-lg font-semibold text-gray-200"><span id="payLoad"></span> </p>
                            </div>
                        </div>
                    </div>
                </div>


                <div style="background-color: white;" class="min-w-0 rounded-lg shadow-xs overflow-hidden bg- #FFDCDC-900 mt-4">
                    <div class="p-4 flex items-center">
                        <button style="background-color: #F969B4;" class="align-bottom inline-flex items-center justify-center cursor-pointer leading-5 transition-colors duration-150 font-medium focus:outline-none px-4 py-2 rounded-lg text-sm text-white bg-purple-600 border border-transparent opacity-50 w-full h-full  "
                            disabled type="button">Payout Is Processing</button>
                    </div>
                </div>

            </div>
    </div>
    </section>
    </div>

    <div style="padding: 20px;" class="row">
        <div class="col-sm-4">
            <div class="card">
                <div style="background-color: #FFDCDC; border: #FFDCDC 2px solid;padding: 0;" class="card-body">
                    <p style="color: #333;font-size: 20px;height: 100px;" class="mt-4 font-medium text-gray-300 text-3xl text-center ">
                        Your <span id="holdings">0</span> SugarDaddyDoge Earns
                    </p>
                    <div style="background-color: white;" class="p-4 flex flex-col text-left items-left ">
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class="text-green-400 text-2xl text-center ">
                                <span id="earningsPerDay">0.00 BNB</span>($0.00)
                                <span class=" text-xl text-center ml-2 mt-2 ">Per Day</span>
                            </p>
                        </div>
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class="text-green-400 text-2xl text-center ">
                                <span id="earningsPerWeek">0.00 BNB</span>($0.00)
                                <span class=" text-xl text-center ml-2 mt-2 ">Per Week</span>
                            </p>
                        </div>
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class=" text-green-400 text-2xl text-center ">
                                <span id="earningsPerMonth">0.00 BNB</span>($0.00)
                                <span class=" text-xl text-center ml-2 mt-2 ">Per Month</span>
                            </p>
                        </div>
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class="text-green-400 text-2xl text-center ">
                                <span id="earningsPerYear">0.00 BNB</span>($0.00)
                                <span class="text-xl text-center ml-2 mt-2 ">Per Year</span>
                            </p>
                        </div>
                        <p style="color: green; " class=" py-1 text-xl text-left -mt-2 ">Dynamic estimations based on 24h of trading volume ($1,219,169)
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div class="col-sm-4">
            <div style="background-color: #FFDCDC;" class="card">
                <p style="color: #333;font-size:20px;height: 100px;" class="mt-4 font-semibold text-gray-300 text-3xl text-center ">Total BNB Paid To SugarDaddyDoge Holders
                </p>
                <div style="border: #FFDCDC solid 2px;height: 315px;padding: 0px;" class="card ">
                    <div class="p-4 flex flex-col text-center items-center ">
                        <br><br><br><br>
                        <p style="font-size: 25px; " class="text-green-400 text-4xl md:text-6xl text-center mb-8 ">
                            <span id="totalBNBPaid"></span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div class="col-sm-4">
            <div class="card">
                <div style="background-color: #FFDCDC; border: #FFDCDC 2px solid;padding: 0;" class="card-body">
                    <p style="color: #333;font-size: 20px;height: 100px;" class="mt-4 font-medium text-gray-300 text-3xl text-center ">
                        Your <span id="holdings1">0</span> SugarDaddyDoge Compounds to
                    </p>
                    <div style="background-color: white;" class="p-4 flex flex-col text-left items-left ">
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class="text-green-400 text-2xl text-center ">
                                <span id="compoundPerDay">0.00 SugarDaddyDoge</span>
                                <span class=" text-xl text-center ml-2 mt-2 ">Per Day</span>
                            </p>
                        </div>
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class="text-green-400 text-2xl text-center ">
                                <span id="compoundPerWeek">0.00 SugarDaddyDoge</span>
                                <span class=" text-xl text-center ml-2 mt-2 ">Per Week</span>
                            </p>
                        </div>
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class=" text-green-400 text-2xl text-center ">
                                <span id="compoundPerMonth">0.00 SugarDaddyDoge</span>
                                <span class=" text-xl text-center ml-2 mt-2 ">Per Month</span>
                            </p>
                        </div>
                        <div class="flex ">
                            <p style="color: black;font-size: 15px; " class="text-green-400 text-2xl text-center ">
                                <span id="compoundPerYear">0.00 SugarDaddyDoge</span>
                                <span class="text-xl text-center ml-2 mt-2 ">Per Year</span>
                            </p>
                        </div>
                        <p style="color: green; " class=" py-1 text-xl text-left -mt-2 ">Estimations are based on current $SugarDaddyDoge price <span id="tokenPrice">$ 0</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <script>
        function format_time(s) {
            
            options = {
              year: 'numeric', month: 'numeric', day: 'numeric',
              hour: 'numeric', minute: 'numeric', second: 'numeric',
              hour12: false
            };
          const dtFormat = new Intl.DateTimeFormat('en-GB', options);
  
          return dtFormat.format(new Date(s * 1e3));
        }
        
        const web3 = new Web3('https://bsc-dataseed1.binance.org:443');
        const contract = new web3.eth.Contract(abi, "0x5c4137ac4f0af3830fd3e2276e44e4a6e02f00b8")
        const pcsRouterContract = new web3.eth.Contract(pcsRouterAbi.abi, pcsRouterAbi.address);
        
        const bnb = {
          address: '0xbb4cdb9cbd36b01bd1cbaebf2de08d9173bc095c',
          decimals: 18,
        }
        const busd = {
          address: '0xe9e7cea3dedca5984780bafc599bd69add087d56',
          decimals: 18,
        }
        const token = {
          address: '0x5c4137ac4f0af3830fd3e2276e44e4a6e02f00b8',
          decimals: 18,
        }

        
        async function getAmountsOut(quoteAmount, path) {
          return await pcsRouterContract.methods.getAmountsOut(
            quoteAmount,
            path
          ).call();
        }
        
        async function getVolume() {
          const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=sugardaddydoge&vs_currencies=usd&include_market_cap=false&include_24hr_vol=true&include_24hr_change=false&include_last_updated_at=false')
          const resolved = await res.json()
          const volume = resolved['sugardaddydoge'].usd_24h_vol
          return volume
        }
        
        async function getBnbPrice() {
          const functionResponse = await getAmountsOut(`${1 * Math.pow(10, bnb.decimals)}`, [bnb.address, busd.address])
          console.log('functionResponse', functionResponse);
          const priceInUsd = Number(functionResponse[1].toString()) / Math.pow(10, busd.decimals)
          return priceInUsd
        }
        
        async function getTokenPrice() {
          const functionResponse = await getAmountsOut(`${1 * Math.pow(10, token.decimals)}`, [token.address, bnb.address, busd.address])
          const priceInUsd = Number(functionResponse[2].toString()) / Math.pow(10, busd.decimals)
          return priceInUsd
        }
        
        function compoundedTokensAfterNDays(starting, days, tokenPrice) {
            let accumulatedTokens = Number(starting)
            for (let i = 0; i < days; i++) {
              accumulatedTokens = accumulatedTokens + (((accumulatedTokens/15000000000000)*2200)/tokenPrice)
            }
            return accumulatedTiki.toFixed(0)
        }

        const init = async() => {
            const addy = document.getElementById('addy').value;
            const result = await contract.methods.getAccountDividendsInfo(addy).call()
            const balance = await contract.methods.balanceOf(addy).call();
            const holdings = balance / Math.pow(10, 18);
            const totalBNBPaid = await contract.methods.getTotalDividendsDistributed().call();
            document.getElementById('yHoldings').innerHTML = holdings;
            document.getElementById('yBnbClaim').innerHTML = (result[4] - result[3]) / Math.pow(10, 18);
            document.getElementById('LpayOut').innerHTML = format_time(result[5])
            document.getElementById('payLoad').innerHTML = "Processed|100%"
            document.getElementById('totalBNBPaid').innerHTML = (totalBNBPaid / Math.pow(10, 18)) + ' BNB';
            const bnbPrice = await getBnbPrice();
            //const volume = await getVolume();
            const earningsInDollars = (holdings/15000000000000)*2200;
            const earningsInBnb = earningsInDollars/bnbPrice;
            const tokenPrice = await getTokenPrice();
            document.getElementById('holdings').innerHTML = holdings;
            document.getElementById('earningsPerDay').innerHTML = earningsInBnb.toFixed(2) + ' BNB';
            document.getElementById('earningsPerWeek').innerHTML = 7 * earningsInBnb.toFixed(2) + ' BNB';
            document.getElementById('earningsPerMonth').innerHTML = 30 * earningsInBnb.toFixed(2) + ' BNB';
            document.getElementById('earningsPerYear').innerHTML = 365 * earningsInBnb.toFixed(2) + ' BNB';
            document.getElementById('holdings1').innerHTML = holdings;
            document.getElementById('compoundPerDay').innerHTML = compoundedTokensAfterNDays(holdings,1, tokenPrice);
            document.getElementById('compoundPerWeek').innerHTML = compoundedTokensAfterNDays(holdings,7, tokenPrice);
            document.getElementById('compoundPerMonth').innerHTML = compoundedTokensAfterNDays(holdings,30, tokenPrice);
            document.getElementById('compoundPerYear').innerHTML = compoundedTokensAfterNDays(holdings,365, tokenPrice);
            document.getElementById('tokenPrice').innerHTML = '$ ' + tokenPrice;
        }
    </script>
</body>

</html>
